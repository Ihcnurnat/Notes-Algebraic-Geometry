\section{Definition: Ringed Space}

\subsection{Local Homomorphism}

The map $\mathscr F^{\sharp}_P$ is defined in Rising Sea's Exercise 2.2.I., PUSHFORWARD INDUCES MAPS OF STALKS.

The condition $\varphi^{-1}(\mathfrak m_B)=\mathfrak m_A$ has equivalent definitions by Lemma \href{https://stacks.math.columbia.edu/tag/07BH}{07BJ} on Stacks Project.

Here is an example of ring homomorphism between local rings that's not a local homomorphism, see a post \href{https://math.stackexchange.com/questions/3752503/example-of-non-local-homomorphism-on-local-rings}{HERE}.

\subsection{Isomorphism of locally ringed space}
See Lemma 01 HC \href{https://stacks.math.columbia.edu/tag/01HA}{Tag 01HA}. This means that if we wish to prove an isomorphism of locally ringed space, we can avoid checking the induced map of local rings. It suffices to check it's isomorphism of ringed space. 

\section{Proposition 2.2.}

\subsection{(b)}

Notice that the map $\psi$ is clearly well-defined.
For $a/f^n=b/f^m$ for some integers $m,n$, the maps is defined as 
\begin{align*}
    \psi:A_f &\to \mathcal O(D(f))\\
    a/f^n &\mapsto s: D(f)\to\prod_{\mathfrak p\in D(f)}A_{\mathfrak p}
\end{align*}where $s(\mathfrak p):=a/f^n\in A_{\mathfrak p}$. Substituting $b/f^m$ into $a/f^n$ will not change the value of the map, therefore it's independent of the choice of representative.

\section{Proposition 2.3.}
See 7.3.2. Key Proposition \cite{RaviRisingSea}.

\section{Example 2.3.2.}

\subsection{References}
See this \href{https://math.mit.edu/~mckernan/Teaching/09-10/Autumn/18.725/l_11.pdf}{NOTE}.

\section{Example 2.3.5.}

For a more general treatment, see \href{https://stacks.math.columbia.edu/tag/01JA}{Section 01JA} of \cite{stacks-project}.

\section{Example 2.3.6.}

Why it's not affine? See this \href{https://mathoverflow.net/questions/87480/explanation-on-a-scheme-which-is-not-affine-scheme}{POST} and a detailed \href{https://math.stackexchange.com/questions/4281800/example-of-scheme-which-is-not-an-affine-scheme}{POST}. 

Some arguments heavily rely on \textit{separated}.

\section{Proj S: Homogeneous Spectrum}

\subsection{Homogeneous}

See this \href{https://math.stackexchange.com/questions/4027174/homogeneous-ideal-in-kx-0-x-n}{POST} for equivalent definitions of homogeneous prime ideal. 

According to \href{https://stacks.math.columbia.edu/tag/00JM}{Tag 00JM}, we have

\textit{To check that a homogeneous ideal $\mathfrak p$ is prime it suffices to check that $\star$ if $ab\in \mathfrak p$ with $a,b$ homogeneous then either $a\in \mathfrak p$ or $b\in \mathfrak p$.}

Say $A,B$ are two elements in the graded ring $S$ such that $AB\in \mathfrak p$, which is assumed to be homogeneous prime. We assume the assumption of $\star$ and we wish to show $A\in\mathfrak p$ or $B\in\mathfrak p$. First of all, we can decompose the elements 
\[A=\sum_{1\leq i\leq n} a_i, B=\sum_{1\leq j\leq m}b_j\] where $a_i\in S_i, b_j\in S_j$ and $n,m$ are some integers. Suppose the assumption $\star$ holds for arbitrary pair of $(a_i,b_j)$, it will implies their sum $A\in \mathfrak p$ or $B\in...$. 

\section{Proposition 2.5.}

\subsection{(a)}

\subsection{(b)}

Notice that when defining homogeneous spectrum, we excluded those homenegeous prime ideal that contains $S_+$. This is because we wish to cover $\operatorname{Proj}S$ with $D_+(f)$. We need to prove the non-trivial inclusion 
\[\operatorname{Proj}S\subset \bigcup_{f\in S_+\cap S^h}D_+(f).\]
Pick an element from LHS, i.e. a homogeneous prime ideal $\mathfrak p$ such that $S_+\not\subset \mathfrak p$. Hence there exists some $f\in S_+$ such that $f'\notin \mathfrak p$, then we can pick a homogeneous part $f:=f'\cap S^h$ such that $f_0\notin \mathfrak p$. This gives us 
\[\mathfrak p\in D_+(f_0).\]
And this proves the desired inclusion, with the converse inclusion apparently holds, we can conclude 
\[\{D_+(f)\}_{f\in S_+\cap S^h}\] is an open covering of homogeneous spectrum $\operatorname{Proj}S$.

\subsection{References}

For more details, see \cite{qing2006algebraic} Chap 2 Lemma 3.36. on Page 52.

\section{Definition: scheme over...}

\subsection{Counterexample}
\textit{Give examples where two $S$-schemes are isomorphic but not isomorphic as $S$-schemes.}


\section{Proposition 2.6.}

\subsection{References}

See this \href{https://math.mit.edu/~mckernan/Teaching/09-10/Autumn/18.725/l_13.pdf}{NOTE} Theorem 13.13. for details.

\section{Exercise 2.1.}\label{Hart Ex 2.1.}

One technical detail is regarding localising twice: See \cite{altman2013term} Proposition 11.16.

\begin{proof}
The homeomorphism of topological spaces between $\operatorname{Spec}A_f$ and $\mathbf D(f)$ is immediate. Denote $f:\operatorname{Spec}A_f\to \mathbf D(f)$, we need to show the induced morphism between sheaves
\[f^{\sharp}:\mathcal O_{\mathbf D(f)}\to f_{\ast}\mathcal O_{\operatorname{Spec}A_f}\] is an isomorphism. And the induced map $f^{\sharp}_{\mathfrak p}$ is a local ring homomorphism: ?

\end{proof}

\subsection{References}

See \cite{qing2006algebraic} Chap 2 Lemma 3.7. and Proposition 3.9. 
See \href{https://stacks.math.columbia.edu/tag/01I3}{Tag 01I3}.

See a counterexample in \href{https://math.stackexchange.com/questions/509009/open-subschemes-of-affine-schemes-are-affine/509018#509018}{POST} regarding Open subschemes of affine schemes are affine?

See a \href{https://math.stackexchange.com/questions/408507/the-distinguished-open-sets-are-affine-subschemes}{POST} \enquote{The distinguished open sets are affine subschemes}.

\section{Exercise 2.2.}

Assume $X$ admits affine covering $\{V_i=\Spec A_i \}_{i\in I}$ for some index set $I$ and ring $A_i$. Notice that $V_i\cap U$ is open, hence we can cover it by distinguished open sets. By previous exercise \Cref{Hart Ex 2.1.}, we know distinguished open subset is an affine scheme. Therefore the locally ringed space $(U,\mathcal O_X\vert_{U})$ is a scheme because it's covered by affine schemes. 

\subsection{References}

See \cite{qing2006algebraic} Chap 2 Lemma 3.9.

\section{Exercise 2.3.}
\textit{\textbf{Reduced Schemes}. A scheme $(X,\mathcal O_X)$ is \textbf{reduced} if for every open set $U\subset X$, the ring $\mathcal O_X(U)$ has no nilpotent elements.}

\subsection{(a)}

\begin{proof}
    $\Leftarrow$:
    We can express the stalk as a filtered colimit 
    \begin{align*}
        \mathcal O_{X,P}
        =&~ \operatorname{colim}_{P\in U}\mathcal O_X(U).
    \end{align*} where each $\mathcal O_X(U)$ is assumed to be reduced. 
    And I claim colimit of reduced ring is again reduced \todo{?}:
    Suppose it has a nilpotent element $a\in\mathcal O_{X,P}$, then there exists some $(U,a)\in \mathcal O_X(U)$ such that $a$ is the image of $(U,a)$ under colimit map $\varphi$ which is a ring homomorphism. Then we have $(U,a)^n$ for some integer $n$ will be mapped to $0$ in the stalk $\mathcal O_{X,P}$. By \cite{altman2013term} Corollary 7.5. (c), there exists some $\mathcal O_X(V)$ for $V\subset U$ such that the image of $(U,a)^n$ will be mapped to $0$ under a transition map $\rho_{UV}$, hence $\rho_{UV}((U,a))^n=0\in\mathcal O_X(V)$, which forces $\rho_{UV}((U,a))=0$ given ring $\mathcal O_X(V)$ is reduced. By commutativity, we have $a$, being an image of $\rho_{UV}((U,a))$, equals to $0$. 

    $\Rightarrow$: 
    See Lemma 01J1 of \href{https://stacks.math.columbia.edu/tag/01IZ}{Tag 01IZ}. 
    Pick a section $f\in\mathcal O_X(U)$ such that $f^n=0$ for some integer $n$. 
    Consider the ring homomorphism $O_X(U)\to O_{X,P}$, which will map $f$ to a nilpotent in $O_{X,P}$ that we assumed to be reduced. While $P\in U$ is arbitrary, then $f$ will be mapped to $0$ under injective map 
    \[O_X(U)\to \prod_{P\in U}O_{X,P}.\] This forces $f=0$ as $\mathcal O_X$ is a sheaf.
\end{proof} 

\subsection{Failed Attempt of (b)}
The reduced scheme $(X,(\mathcal O_X)_{\text{red}})$ is indeed a scheme. For every point $P\in X$, there exists an open subset $U$ such that $(U,\mathcal O_X\vert_U)\simeq (\operatorname{Spec}A,\mathcal O_{\operatorname{Spec}A})$.

To define a morphism from $X_{\text{red}}\to X$, we take identity $\operatorname{id}:\operatorname{sp}(X_{\text{red}})\to\operatorname{sp}(X)$ as the homeomorphism between the underlying topological spaces. It remains to define a morphism of sheaves from 
\[f^{\sharp}:\mathcal O_X\to\operatorname{id}_{\ast}(\mathcal O_X)_{\text{red}}=:\mathcal G\] such that $f^{\sharp}_P:\mathcal O_{X,P}\to \mathcal G_P$ is a local ring homomorphism. 

Fix an open subset $U\subset X$, we define $f^{\sharp}(U)$ as 
\begin{align*}
    f^{\sharp}(U):\mathcal O_X(U)\to\mathcal G(U)=\operatorname{id}_{\ast}(\mathcal O_X)_{\text{red}}(U)=\mathcal O_{\text{red}}(U)
\end{align*}

\subsection{References}
See \href{https://stacks.math.columbia.edu/tag/01IZ}{Tag 01IZ}. See \href{https://math.stackexchange.com/questions/437227/colimit-of-reduced-rings}{POST}, and \href{https://math.stackexchange.com/questions/2737301/reducedness-and-colimit}{POST} discussing colimit of reduced ring. See a solution \href{https://www.math.ncku.edu.tw/~fjmliou/alg/reduced_scheme.pdf}{HERE}.

On reduced presheaf isn't a sheaf \href{https://math.stackexchange.com/questions/338185/the-reduced-presheaf}{HERE}. Discussion on Ex 2.3. (b), \href{https://math.stackexchange.com/questions/682230/exercise-2-3-from-hartshornes-algebraic-geometry}{POST}, \href{https://math.stackexchange.com/questions/441031/reduced-schemes-and-global-sections}{POST}. For (b), a standard treatment is \cite{qing2006algebraic} Chapter 2 2.4 on Page 59.

\section{Exercise 2.4.}\label{Hart Chap 2 Ex 2.4.}

\enquote{Morphism into an affine scheme}

Isn't this a direct application of Proposition 2.3. \cite{hartshorne2013algebraic}? We'll use Prop 2.3. in the proof. See \Cref{Hart Chap 2 Ex 2.7.} for morphism from an affine scheme with global section of a field.

\section{references}

See Theorem I-40 on Page 30 of \cite{eisenbud2006geometry}.
See \cite{gortz2020algebraic} Proposition 3.4. Chap 3 on Page 69. Rising Sea \cite{RaviRisingSea} 7.3.4.

\section{Exercise 2.5.}

Corollary of previous Exercise 2.4 \Cref{Hart Chap 2 Ex 2.4.}. See Corollary 3.6. Chap 3 of \cite{gortz2020algebraic}.

\section{Exercise 2.7.}\label{Hart Chap 2 Ex 2.7.}
The following proof is based on Lecture 53 of S\'andor's Notes on Algebraic Geometry \cite{SandorNotesAlgebraicGeometry}.

\begin{proof}
    To specify a morphism between locally ringed spaces, we have to give a continuous map of topological spaces and morhism of sheave of rings. A continuous map is given by choosing a point $x$ of $X$ for the spectrum $\operatorname{Spec}K$ is a single point. Here we denote this map as $f:\operatorname{Spec}K\to X$. 

    As definition specified, the morphism of sheaves $\mathscr O_{X}\to f_{\ast}\mathscr O_{\Spec K}$ induces a local ring homomorphism on stalks at $x\in X$. Notice that $0\in \Spec K$ is the pre-image of $x$, then 
    \[\mathscr O_{X,x}\to f_{\ast}\mathscr O_{\Spec K,0}=K\]
    is a local ring homomorphism. As $K$ is a field, the pre-image of maximal ideal $0$ must be exactly the maximal ideal of $\mathscr O_{X,x}$. This morphism cannot be zero morphism, so it must be surjective. The kernel of this morphism is exactly $\mathcal m_x\triangleleft_{\text{max}}\mathscr O_{X,x}$, which implies the isomorphism of 
    \[\mathscr O_{X,x}/\mathcal m_x=\kappa (x)\simeq k.\] 
\end{proof}

\subsection{First Attempt}
We wish to prove a morphism on sheaves of rings 
\[f^{\sharp}:\mathscr O_{X}\to f_{\ast}\mathscr O_{\operatorname{Spec}K}\] will corresponds bijectively to an inclusion map $k(x)\to K$.  \todo{Use \href{https://stacks.math.columbia.edu/tag/008K}{Tag 008K} to simplify the construction of the morphism?}

Give an open subset $U\subset X$, we can define $f^{\sharp}(U)$ as 
\begin{align*}
    \mathscr O_X(U)\to f_{\ast}\mathscr O_{\operatorname{Spec}K} (U)=
\end{align*} 

\subsection{Remarks}

For converse direction, see Proposition 3.8. Chap 3 of \cite{gortz2020algebraic}. Notice that this problem is NOT completely analoguous to \Cref{Hart Chap 2 Ex 2.4.}, because here the global section of the affine scheme is a field. There is a slightly more general statement regarding when global section is a local ring, see comments of Prop 3.8. Chap 3 of \cite{gortz2020algebraic}.

\section{Exercise 2.9.}\label{Hart Chap 2 Ex 2.9.}

\textit{If $X$ is a scheme, show that every (nonempty) irreducible closed subset has a unique generic point.}

\begin{proof}
    Let $Z\subset X$ be a non-empty irreducible closed subsets. If we assume the existence of a generic point, then it must be unique. Otherwise we take the closure of two generic points will contradict irreducibility of the $Z$. 

    It remains to check the existence. Take an open subset $U:=X\setminus (X\setminus Z)^{-}\subset Z$, and we can find an affine open $\Spec R\subset \subset U$ for affine opens form a basis for the scheme. Here $R$ is a ring. And the generic point $\xi\in \Spec R$ corresponds to the minimal prime of $R$. The existence of minimal prime implies the existence of generic point $\xi$. 
    Furthermore, the point $\xi$ will be the generic point for $Z$ because $\Spec R$ is dense in $Z$ given $Z$ is irreducible.
    \[\operatorname{Cl}_Z(\xi)=\operatorname{Cl}_Z(\operatorname{Cl}_U(\xi))=\operatorname{Cl}_Z(U)=Z.\]

\end{proof}
    

\subsection{Solution}

See this \href{https://math.stackexchange.com/questions/3744236/every-irreducible-closed-has-a-generic-point#comment7703441_3745580}{POST} \enquote{Every irreducible closed has a generic point}. Another way to describe the generic point $\xi$ is to define it as the nilradical of $R$. Notice that the nilradical here is a prime because \enquote{nonempty aﬃne scheme $X = \Spec(A)$ is irreducible if and only if the nilradical of $A$ is a prime ideal} by this \href{https://ocw.mit.edu/courses/18-726-algebraic-geometry-spring-2009/3723a99e97b581828fd782b9ffd83921_MIT18_726s09_lec11_more_schemes.pdf}{NOTE} Lemma 3 on Page 2.

For existence of minimal prime, see \enquote{A Term...} \cite{altman2013term} 3.17 and Exercise 3.16 on Page 21. 

See Proposition 3.23 Chap 3 on Page 78 \cite{gortz2020algebraic}.

\section{Exercise 2.12.}

\subsection{Remarks}

Notice that in order to be defined, the diagram of morphism $\varphi_{ik}=\varphi_{jk}\circ\varphi_{ij}$ admits a diagram as in \href{https://stacks.math.columbia.edu/tag/01JA}{Tag 01JA}.

See Rising Sea Exercise 4.4.A. \Cref{4.4.A.}, in fact the inverse condition given as (1) and identity are redundent.

\section{Exercise 2.13.}\label{Hart Chap 2 Ex 2.13.}

\subsection{(a)}

$\Leftarrow$: In particular, the space $X$ is quasi-compact. For any ascending chain of open subsets, they form an open covering of $X$, hence we can reduce to finite many of them. Take the largest one open set $U_0$, the chain will terminate there. 

$\Rightarrow$: Fix an open subset $U$ with an opne covering $\{U_i\}_{i\in I}$ where $I$ is an index set. It must reduce to finite sub-cover otherwise we can form an (strictly) ascending chain of open subsets in $U$, hence in $X$, which contradicts the fact that $X$ is Noetherian. 

\subsection{(b)}

For space $\operatorname{sp}(X)$ is quasi-compact see Atiyah's Exercise in Chapter 1. 

Example of an affine scheme $X$ whose underlying space $\operatorname{sp}(X)$ is not Noetherian: 
\[\operatorname{Spec}k[x_1,x_2,x_3,...]\] because we have infinitely descending chain of closed subsets, which corresponds to infinitely ascending ideals. \todo{?}


\subsection{Verification}

See this \href{https://math.stackexchange.com/questions/1442665/a-noetherian-topological-space-is-compact}{POST}, \href{https://math.stackexchange.com/questions/2745543/v-is-noetherian-space-if-only-if-every-open-subset-of-v-is-compact}{POST}.

For (b), see this \href{https://math.stackexchange.com/questions/4690764/is-this-space-noetherian}{POST}.

See standard counterexample for part (d) \href{https://math.stackexchange.com/questions/1611732/example-of-non-noetherian-ring-whose-spectrum-is-noetherian/1611757#1611757}{HERE}, \href{https://math.stackexchange.com/questions/7392/a-non-noetherian-ring-with-noetherian-spectrum}{HERE}.


\section{Exercise 2.16.}\label{Hart Chap 2 Ex 2.16.}

\subsection{(a)}
\begin{proof}

% https://q.uiver.app/#q=WzAsMyxbMCwwLCJmXFxpblxcbWF0aHNjciBPX1goWCkiXSxbMSwwLCJcXG92ZXJsaW5lIGZcXGluXFxtYXRoc2NyIE9fWChVKSJdLFsxLDEsIlxcbWF0aGZyYWsgbV97XFxtYXRoZnJhayBwfVxcdHJpYW5nbGVsZWZ0X3tcXHRleHR7cHJpbWV9fVxcbWF0aHNjciBPX3tYLFxcbWF0aGZyYWsgcH0iXSxbMCwxLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzEsMiwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFswLDIsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XV0=
\[\begin{tikzcd}
	{f\in\mathscr O_X(X)} & {\overline f\in\Gamma(U,\mathscr O_{X\vert U})=B} \\
	& {f_\mathfrak p=\overline f_{\mathfrak p}\in\mathfrak m_{\mathfrak p}\triangleleft_{\text{prime}}\mathscr O_{X,\mathfrak p}}
	\arrow[maps to, from=1-1, to=1-2]
	\arrow[maps to, from=1-2, to=2-2]
	\arrow[maps to, from=1-1, to=2-2]
\end{tikzcd}\]
\begin{align*}
    U\cap X_f =&~ \{x\in U ~\mid~ f_x\notin \mathfrak m_x\}\\
    =&~ \{x\in U ~\mid~ f_x\in \mathscr O_{X,x}^{\times}\}\\
    =&~ \{\mathfrak p\in U ~\mid~ f_{\mathfrak p} \in \mathscr O_{X,\mathfrak p}^{\times}\}\\
    =&~ \{\mathfrak p\in U ~\mid~ f_{\mathfrak p}\in (B_{\mathfrak p})^{\times}\}\\
    =&~ \{\mathfrak p\in U ~\mid~ f_{\mathfrak p}\in \mathfrak m_{\mathfrak p}:=\mathfrak p B_{\mathfrak p}\}^C\\
    =&~ \{\mathfrak p\in \operatorname{Spec}B=U ~\mid~ (\overline f)\subset \mathfrak p\}^C ~\text{ by commutativity of the diagram}\\
    =&~ \mathbf D_U(\overline f)=\mathbf D(\overline f).
\end{align*}
Therefore $X_f$ is an open subset because all affine open form an open basis and intersection with each is open inside each basis element. 
\end{proof}

In fact, the notion of $X_f$ generalises this equality $(\operatorname{Spec}B)_g=\operatorname{Spec}B_g$ in which left hand side is regarded in the definition of this exercise and right hand side is regarded in the usual sense. 

\subsection{(b)}

\begin{proof}

Restriction map gives us the following commutative diagram for each $1\leq i\leq n$.

% https://q.uiver.app/#q=WzAsNCxbMSwwLCJhXFxpblxcR2FtbWEoWCxcXG1hdGhjYWwgT19YKT1BIl0sWzAsMSwiXFxHYW1tYShVX2ksXFxtYXRoY2FsIE9fWCk9Ql9pIl0sWzIsMSwiXFxHYW1tYShYX2YsXFxtYXRoY2FsIE9fWClcXG5pIDAiXSxbMSwyLCJcXEdhbW1hKFVfaVxcY2FwIFhfZixcXG1hdGhjYWwgT19YKVxcbmkgMCJdLFswLDFdLFswLDJdLFsxLDNdLFsyLDNdXQ==
\[\begin{tikzcd}
	& {f,a\in\Gamma(X,\mathcal O_X)=A} \\
	{\Gamma(U_i,\mathcal O_X\vert_{U_i})=B_i} && {\Gamma(X_f,\mathcal O_X)\ni 0} \\
	& {\Gamma(U_i\cap X_f,\mathcal O_X\vert_{U_i})\ni 0}
	\arrow[from=1-2, to=2-1]
	\arrow[from=1-2, to=2-3]
	\arrow[from=2-1, to=3-2]
	\arrow[from=2-3, to=3-2]
\end{tikzcd}\]
    We can compute by part (a) that for $1\leq i\leq n$, 
    \begin{align*}
        \Gamma(U_i\cap X_f,\mathcal O_X\vert_{U_i})=&~\Gamma(D_{U_i}(\overline f),\mathcal O_X\vert_{U_i})\\
        =&~\Gamma(D_{U_i}(\Res_i(f)),\mathcal O_X\vert_{U_i})\\
        =&~ \{1, \Res_i(f), \Res_i(f)^2,...\}^{-1}B_i.
    \end{align*}
    While $a$ will restrict to $0$ in $X_f$, hence it will be mapped to $0\in \{1, \Res_i(f), \Res_i(f)^2,...\}^{-1}B_i$. 

    Given $X$ is quasi-compact, let $U_1,...,U_n$ be affine opens of $X$ where $n$ is some integer with global sections $B_1,...,B_n$. We have the following diagram 

    % https://q.uiver.app/#q=WzAsNyxbMSwwLCJmLGFcXGluXFxHYW1tYShYLFxcbWF0aGNhbCBPX1gpPUEiXSxbMCwxLCJcXEdhbW1hKFVfMSxcXG1hdGhjYWwgT19YXFx2ZXJ0X3tVXzF9KT1CXzEiXSxbMCwyLCJCX3sxe1xcb3BlcmF0b3JuYW1le1Jlc31fMShmKX19PVxcezEsXFxvcGVyYXRvcm5hbWV7UmVzfV8xKGYpLFxcb3BlcmF0b3JuYW1le1Jlc31fMShmKV4yLC4uLlxcfV57LTF9Ql8xIl0sWzIsMSwiXFxHYW1tYShVX24sXFxtYXRoY2FsIE9fWFxcdmVydF97VV9ufSk9Ql9uIl0sWzIsMiwiQl97bntcXG9wZXJhdG9ybmFtZXtSZXN9X24oZil9fSJdLFsxLDEsIlxcZG90cyJdLFsxLDIsIlxcZG90cyJdLFswLDEsIlxcb3BlcmF0b3JuYW1le1Jlc31fMSIsMl0sWzEsMl0sWzAsMywiXFxvcGVyYXRvcm5hbWV7UmVzfV9uIl0sWzMsNF0sWzAsNSwiXFxkb3RzIl0sWzUsNl1d
\[\begin{tikzcd}
	& {f,a\in\Gamma(X,\mathcal O_X)=A} \\
	{\Gamma(U_1,\mathcal O_X\vert_{U_1})=B_1} & \dots & {\Gamma(U_n,\mathcal O_X\vert_{U_n})=B_n} \\
	{B_{1{\operatorname{Res}_1(f)}}=\{1,\operatorname{Res}_1(f),\operatorname{Res}_1(f)^2,...\}^{-1}B_1} & \dots & {B_{n{\operatorname{Res}_n(f)}}}
	\arrow["{\operatorname{Res}_1}"', from=1-2, to=2-1]
	\arrow[from=2-1, to=3-1]
	\arrow["{\operatorname{Res}_n}", from=1-2, to=2-3]
	\arrow[from=2-3, to=3-3]
	\arrow["\dots", from=1-2, to=2-2]
	\arrow[from=2-2, to=3-2]
\end{tikzcd}\]

    We claim lower map from $B_i\to\{1, \Res_i(f), \Res_i(f)^2,...\}^{-1}B_i$ is localisation. One possible interpretation is to recall construction of spectrum of a ring on Page 70 of \cite{hartshorne2013algebraic}. Another interpretation is that, by (a) and \Cref{Hart Ex 2.1.} we know the open subsets $U_i\cap X_f=D_{U_i}(\overline f)$ is an affine scheme. Then apply Proposition 2.3 Chap 2 of Hartshrone \cite{hartshorne2013algebraic} proves the localisation map is indeed the map between them. 

    Now, we can apply definition of localisation: 
    \begin{align*}
        &\Res_i(a)/1=0\in \{1, \Res_i(f), \Res_i(f)^2,...\}^{-1}B_i ~\Leftrightarrow~ \\
        \exists n_i\in\mathbb Z,~ &\Res_i(f)^n \Res_i(a)=\Res_i(f^na)=0\in B_i.
    \end{align*}
    Now we pick the largest index $N=\max{n_i}_{1\leq i\leq n}$. Notice that $f^Na$ will be mapped to $0$ in each $B_i=\Gamma(U_i,\mathcal O_X\vert_{U_i})$, while $\{U_i\}_{1\leq i\leq n}$ is an open covering of the whole space, by sheaf axiom we know $f^Na=0\in \Gamma(X,\mathcal O_X)$.

\end{proof} 

\subsection{(c)}

Statement of the prompt is misleading. I combined part (c) and (d).

\begin{proof}
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJmXFxpbiBBPVxcR2FtbWEgKFgsXFxtYXRoY2FsIE9fWCkiXSxbMiwwLCJcXEdhbW1hKFhfZixcXG1hdGhjYWwgT197WF9mfSkiXSxbMSwxLCJBX2YiXSxbMCwxLCJcXG9wZXJhdG9ybmFtZXtSZXN9Il0sWzAsMl0sWzIsMSwiIiwyLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV1d
\[\begin{tikzcd}
	{f\in A=\Gamma (X,\mathcal O_X)} && {\Gamma(X_f,\mathcal O_{X_f})} \\
	& {A_f}
	\arrow["{\operatorname{Res}}", from=1-1, to=1-3]
	\arrow[from=1-1, to=2-2]
	\arrow[dashed, from=2-2, to=1-3]
\end{tikzcd}\]

Firstly, we try to construct a map from $A_f$ to $\Gamma(X_f,\mathcal O_{X_f})$ by universal property of localisation. It suffices to check $f$ will be mapped to a unit under restriction map $\Res$.

% https://q.uiver.app/#q=WzAsMyxbMCwwXSxbMSwxLCJmX3hcXGluXFxtYXRoY2FsIE9fe1gseH1cXG5pIDEvZl94Il0sWzEsMCwiZlxcaW5cXG1hdGhjYWwgT19YKFVfeClcXG5pIGciXSxbMiwxLCIiLDAseyJvZmZzZXQiOjF9XSxbMiwxLCIiLDIseyJvZmZzZXQiOi01LCJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV1d
\[\begin{tikzcd}
	{} & {f\in\mathcal O_X(U_x)\ni g} \\
	& {f_x\in\mathcal O_{X,x}\ni 1/f_x}
	\arrow[shift right, from=1-2, to=2-2]
	\arrow[shift left=5, maps to, from=1-2, to=2-2]
\end{tikzcd}\]

Now let's consider for $x\in X_f=\{x\in X ~\vert~ f(x)\neq 0\in \kappa (x)\}$. Section $f\in A$ admits a representative in $\mathcal O_{X,x}$, i.e. there exist $U'_x\subset X$ contains $x$ such that $f\in \mathcal O_{X}(U'_x)$. Similarly, for $1/f_x$, it will corresponds a section $g\in \mathcal O_{X}(U''_x)$ on some open neighborhood $U''_x$ of $x$ such that $g_x=1/f_x$ given $f_x$ is a unit in the stalk $\mathcal O_{X,x}$. Denote $U_x=U'_x\cap U''_x$. Locally on $\mathcal O(U_x)$, we have 
\[f\vert_{U_x}g\vert_{U_x}=1\] because in ring homomorphism $\mathcal O_X(U_x)\to \mathcal O_{X,x}$, the preimage of $1$ must be $1$ and $f_xg_x=1$ by our construction. 

For different $x\in X_f$, we have an open cover $\{U_x\}_{x\in X_f}$. Since $f\in \Gamma (X,\mathcal O_X)$, so it satisfy all sheaf axiom. 
\[g\vert_{U_x}\vert_{U_x\cap U_y}=(1/f\vert_{U_x})\vert_{U_x\cap U_y}=(1/f\vert_{U_y})\vert_{U_x\cap U_y}=g\vert_{U_y}\vert_{U_x\cap U_y}\] implies there exist $g\in \Gamma (X_f,\mathcal O_{X_f})$ such that $\Res f g=1\in \Gamma(X_f,\mathcal O_{X_f})$ by sheaf axiom(used twice, one for existence of $g$, one for identifying $\Res f g$). Hence we have the map by universal property of localisation. 

It remains to check surjectivity of this map. 

\end{proof}

\subsection{Hint}


Probably the most elegant and official proof is given as Proposition 3.12 in Chap 2 of \cite{qing2006algebraic}. It didn't involve the check according to the hint of part (a) and construct the map in part (c) immediately. See this \href{https://math.stackexchange.com/questions/2815859/hartshorne-algebraic-geometry-exercise-ii-2-16}{POST}. See this \href{https://math.berkeley.edu/~cjdowd/hartshorne.html}{Webpage} which leads to this \href{https://math.stackexchange.com/questions/57077/on-affine-local-properties}{POST}. See \href{https://math.stackexchange.com/questions/4686052/hartshorne-ex-ii-2-16-part-b}{POST} for Hartshorne ex II 2.16 part b. See \href{https://math.stackexchange.com/questions/2407252/help-doing-an-exercise-on-a-criterion-for-affiness-from-hartshorne}{POST} for details.

\section{Exercise 2.17.}

\subsection{(a)}

On Page 73, Definition of ringed space, we have an equivalent definition of a morphism $(f,f^{\sharp})$ being an isomorphism. One proof I didn't write down(I'm afraid it will evolve many glue arguments) was to prove the ring isomorphism $f^{\sharp}(V):\mathcal O_Y(V)\to f_{\ast}\mathcal O_X(V)$. A more convenient approach was to apply Prop 1.1. directly given that we observe the isomorphism on the level of stalks. 

\begin{proof}
For topological space, the inverse is clear to define. It remains to check 
\[f^{\sharp}:\mathcal O_Y\to f_{\ast}\mathcal O_X\] is an isomorphism. 

% https://q.uiver.app/#q=WzAsNixbMCwwLCJcXG1hdGhjYWwgT19ZKFYpIl0sWzEsMCwiXFxtYXRoY2FsIE9fWChmXnstMX0oVikpPWZfe1xcYXN0fVxcbWF0aGNhbCBPX1giXSxbMCwxLCJcXG1hdGhjYWwgT19ZKFZcXGNhcCBVX2kpIl0sWzEsMSwiXFxtYXRoY2FsIE9fWChmXnstMX0oVlxcY2FwIFVfaSkpIl0sWzAsMiwiKFxcbWF0aGNhbCBPX1kpX1AiXSxbMSwyLCIoZl97XFxhc3R9XFxtYXRoY2FsIE9fWClfe1B9PVxcbWF0aGNhbCBPX3tYLGZeey0xfShQKX0iXSxbMCwyXSxbMSwzXSxbMiwzLCJcXHNpbWVxIiwyXSxbMCwxLCJmXntcXHNoYXJwfShWKSJdLFsyLDRdLFszLDVdLFs0LDUsIlxcc2ltZXEiLDJdXQ==
\[\begin{tikzcd}
	{\mathcal O_Y(V)} & {\mathcal O_X(f^{-1}(V))=f_{\ast}\mathcal O_X} \\
	{\mathcal O_Y(V\cap U_i)} & {\mathcal O_X(f^{-1}(V\cap U_i))} \\
	{(\mathcal O_Y)_P} & {(f_{\ast}\mathcal O_X)_{P}=\mathcal O_{X,f^{-1}(P)}}
	\arrow["{f^{\sharp}(V)}", from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow["\simeq"', from=2-1, to=2-2]
	\arrow[from=2-1, to=3-1]
	\arrow[from=2-2, to=3-2]
	\arrow["\simeq"', from=3-1, to=3-2]
\end{tikzcd}\]

Here $V$ denotes an open subset of $Y$.
We'll apply Proposition 1.1. Chapter 2 \cite{hartshorne2013algebraic}. For an arbitrary $P\in V$, we can find some $U_i\cap V$ contains $P$ for $\{U_i\}$ covers $Y$.

Notice that we have, on one hand $f^{\sharp}:\mathcal O_Y\to f_{\ast}\mathcal O_X$, and on the other hand $\mathcal O_{U_i}\to (f\vert_{f^{-1}(U_i)})_{\ast} \mathcal O_{f^{-1}(U_i)}$. They'll induced the same stalks as we observe that for $P\in U_i$, 
\begin{align*}
    (\mathcal O_Y)_P&=(\mathcal O_{U_i})_P,\\ 
    (f_{\ast}\mathcal O_X)_P&=( (f\vert_{f^{-1}(U_i)})_{\ast} \mathcal O_{f^{-1}(U_i)})_P.
\end{align*}
Given $f^{-1}(U_i)\to U_i$ is an isomorphism, therefore 
\[\mathcal O_{U_i}\to (f\vert_{f^{-1}(U_i)})_{\ast}\mathcal O_{f^{-1}(U_i)}\]is an isomorphism of sheaves. Therefore we have 
\[(\mathcal O_Y)_P\simeq (f_{\ast}\mathcal O_X)_P\] for $P\in U_i$. While $\{U_i\}$ is an open covering, then the statement could be generalised for any $P\in Y$. This proves 
\[f^{\sharp}:\mathcal O_Y\to f_{\ast}\mathcal O_X\] is an isomorphism of sheaves by Proposition 1.1. Chap 2 \cite{hartshorne2013algebraic}.
\end{proof}

\begin{comment}
For each $i$, we have an isomorphism of sheaves 
\[f_i^{\sharp}:\mathcal O_{U_i}\to (f\vert_{U_i})_{\ast}\mathcal O_{f^{-1}(U_i)}=f_{\ast}\mathcal O_{f^{-1}(U_i)}.\]
It remains to define $f^{\sharp}:\mathcal O_Y\to f_{\ast}\mathcal O_X$. 
For an open subset $V\subset Y$, we have 
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXG1hdGhjYWwgT19ZKFYpIl0sWzEsMCwiXFxtYXRoY2FsIE9fWChmXnstMX0oVikpIl0sWzAsMSwiXFxtYXRoY2FsIE9fWShWXFxjYXAgVV9pKSJdLFsxLDEsIlxcbWF0aGNhbCBPX1goZl57LTF9KFZcXGNhcCBVX2kpKSJdLFswLDJdLFsxLDNdLFsyLDMsIlxcc2ltZXEiLDJdLFswLDEsIiIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	{\mathcal O_Y(V)} & {\mathcal O_X(f^{-1}(V))} \\
	{\mathcal O_Y(V\cap U_i)} & {\mathcal O_X(f^{-1}(V\cap U_i))}
	\arrow[dashed, from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow["\simeq"', from=2-1, to=2-2]
\end{tikzcd}\]
Hence we can define 
\begin{align*}
    f^{\sharp}(V):\mathcal O_Y(V)&\to \mathcal O_X(f^{-1}(V))\\ 
                    s &\mapsto \begin{cases}
                        f_i^{\sharp}(U_i)(s) & \text{ given } s\in \mathcal O_Y(V\cap U_i)\\
                        ... & ...
                    \end{cases}.
\end{align*}
This is well-defined because $\{U_i\}$ covers $Y$ and $f_i^{\sharp}(U_i)(s)=f^{\sharp}(U_i\cap U_j)(s)=f_j^{\sharp}(U_j)(s)$ when $s\in \mathcal O_Y(V\cap U_i),s\in\mathcal O_Y(V\cap U_j)$. And clearly $f^{\sharp}(V)$ is an isomorphism. Therefore $\mathcal O_Y\to f_{\ast}\mathcal O_X$.
\end{comment}

\subsection{(b)}

$\Rightarrow$: When $X$ is affine, we can take finitely many such $f_i$ (which generate the global section $\Gamma (X,\mathcal O_X)$) for affine scheme is quasi-compact. And we know distinguished open is affine.

$\Leftarrow$: Assume that each $X_{f_i}$ is affine. By Chap 2 Ex 2.16. of Hartshorne \cite{hartshorne2013algebraic} \Cref{Hart Chap 2 Ex 2.16.}, $\Gamma(X_{f_i},\mathcal O_{X_{f_i}})=A_{f_i}$ for some ring $A_i$ where $1\leq i\leq r$. 

We need to show that $X\to \Spec A$ is an isomorphism. 
Given the localisation map $A\to A_{f_i}=\Gamma(X_{f_i},\mathcal O_{X_{f_i}})$, Ex 2.4 induces morphism $h_i:X_{f_i}\to \Spec A$ for each $1\leq i\leq r$. Gluei morphisms $h_i$\todo{??}. Since $\{\mathbf D(f_i)\}_{1\leq i\leq r}$ is an open covering of $\Spec A$ given $f_1,...,f_r$ generate the unit ideal. By part (a), it remains to check...

\section{Comments}

See this \href{https://math.stackexchange.com/questions/3116537/criterion-for-affine-scheme-via-glueing}{POST}. See this \href{https://math.stackexchange.com/questions/4685088/hartshorne-chapter-2-exercise-2-17}{POST} regarding part (a). In fact, after reading this post I realised the topological part of the proof could take some words.\todo{?}

\section{Exercise 2.18.}

\subsection{(a)}

Notice that $\sqrt{\langle f\rangle}=\sqrt{\langle f^n\rangle}=0\subset \mathfrak p$ for any prime ideal $\mathfrak p\triangleleft A$. For the dirction \enquote{empty $\Rightarrow$ nilpotent}...\todo{need to finish}

\subsection{(b)}

Assume $\varphi:A\to B$ is injective. In order to check $f^{\sharp}$ is injective, it suffices to check on $\mathbf D(g)\subset X=\Spec A$, the map $f^{\sharp}(\mathbf D(g)):\mathcal O_X(\mathbf D(g))\to f_{\ast}\mathcal O_Y(\mathbf D(g))$ is injective. 
\begin{align*}
    f^{\sharp}(\mathbf D(g))&:\mathcal O_X(\mathbf D(g))\to f_{\ast}\mathcal O_Y(\mathbf D(g))=\mathcal O_Y(f^{-1}(\mathbf D(g)))=\mathcal O_Y(\mathbf D(\varphi(g)))\\
    \Rightarrow~ f^{\sharp}(\mathbf D(g))&:A_g\to B_{\varphi(g)}
\end{align*}
Is this map the localisation induced by $\varphi:A\to B$? If so, then we can conclude injectivity of $f^{\sharp}:\mathcal O_X\to f_{\ast}\mathcal O_Y$.

% https://q.uiver.app/#q=WzAsNCxbMCwwLCJnXFxpbiBBPVxcbWF0aGNhbCBPX1goWCkiXSxbMSwwLCJCPWZfe1xcYXN0fVxcbWF0aGNhbCBPX1koWClcXG5pIFxcdmFycGhpKGcpIl0sWzAsMSwiQV9nIl0sWzEsMSwiQl97XFx2YXJwaGkoZyl9Il0sWzAsMSwiXFx2YXJwaGk9Zl57XFxzaGFycH0oWCkiXSxbMCwyXSxbMSwzXSxbMiwzLCJcXGV4aXN0cyAhIiwyLHsiY3VydmUiOjEsInN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dLFsyLDMsImZee1xcc2hhcnB9KFxcbWF0aGJmIEQoZykpIiwwLHsiY3VydmUiOi0xfV1d
\[\begin{tikzcd}
	{g\in A=\mathcal O_X(X)} & {B=f_{\ast}\mathcal O_Y(X)\ni \varphi(g)} \\
	{A_g} & {B_{\varphi(g)}}
	\arrow["{\varphi=f^{\sharp}(X)}", from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow["{\exists !}"', curve={height=6pt}, dashed, from=2-1, to=2-2]
	\arrow["{f^{\sharp}(\mathbf D(g))}", curve={height=-6pt}, from=2-1, to=2-2]
\end{tikzcd}\]

Here we wish to identify $f^{\sharp}$ with the localization. Notice that we can check by universal property of localisation that $g$ will be mapped to a unit in $B_{\varphi(g)}$, therefore there exists a unique map such that the above diagram commutes. While $f^{\sharp}$ being a natural transformation we know $f^{\sharp}(\mathbf D(g))$ will make this diagram commute, then two maps is the same. And we can conclude the injectivity of $f^{\sharp}$. 

What we've done is to check the injectivity of the morphism of sheaves on base, which will induced an injective morphism of sheaf by Exercise 2.7. Chap 2 on Page 40 \cite{qing2006algebraic}.

Conversely, if we assume $f^{\sharp}$ is injective. We can localise at every point of $X$ which give rise to an injective morphism by Prop 3.9. on Page 40 of Atiyah \cite{atiyah1994introduction}. Or we can just take the global section, which recovers to ring map $\varphi:A\to B$ more quickly.

%We wish to compute the induced morphism $f^{\sharp}_x$ where $x\in X=\Spec A$ on stalk is injective: \begin{align*}\mathcal O_X\to f_{\ast}\mathcal O_Y\to f_{\ast}\mathcal O_{Y,x}\\\Rightarrow~ \end{align*}

\subsection{Solution}

For example, see \href{https://stacks.math.columbia.edu/tag/00DY}{Tag 00DY}. 
See a post \href{https://math.stackexchange.com/questions/4686443/injectivity-of-map-on-sheaves-f-sharp-mathcalo-x-to-f-mathcalo-y-h?rq=1}{HERE}, \href{https://math.stackexchange.com/questions/424884/possible-mistake-in-exercise-in-hartshorne-exercise-ii-2-18b?noredirect=1&lq=1}{HERE}, and \href{https://math.stackexchange.com/questions/424884/possible-mistake-in-exercise-in-hartshorne-exercise-ii-2-18b}{HERE}.

\section{Exercise 2.19.}

Firstly prove (ii) $\Leftrightarrow$ (iii), then prove (iii) $\Rightarrow$ (i). 

For (i) $\Rightarrow$ (iii), 

% https://q.uiver.app/#q=WzAsNSxbMCwwLCJBIl0sWzEsMCwiXFxHYW1tYShVLFxcbWF0aGNhbCBPXFx2ZXJ0X3suLi59KSJdLFswLDEsIlxcR2FtbWEoVixcXG1hdGhjYWwgT1xcdmVydF97Li4ufSkiXSxbMSwxLCIxPVxcR2FtbWEoXFxlbXB0eXNldCxcXG1hdGhjYWwgT1xcdmVydHsuLi59KSJdLFsyLDIsIj8iXSxbMCwxXSxbMCwyXSxbMiwzXSxbMSwzXSxbMiw0XV0=
\[\begin{tikzcd}
	A & {\Gamma(U,\mathcal O\vert_{...})} \\
	{\Gamma(V,\mathcal O\vert_{...})} & {1=\Gamma(\emptyset,\mathcal O\vert{...})} \\
	&& {?}
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-1, to=3-3]
\end{tikzcd}\] \todo{?}

\subsection{Hint}

Because $\operatorname{Spec}$ is a contravariant functor.